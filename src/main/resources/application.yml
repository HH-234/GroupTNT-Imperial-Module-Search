spring:
  application:
    name: bioeng-tsn-app
  main:
    # 同时依赖 web + webflux（为了 WebClient / Mono）时，强制以 Servlet(Tomcat) 模式启动
    web-application-type: servlet
    # 允许 Bean 定义覆盖（防止 WebFlux 自动配置冲突）
    allow-bean-definition-overriding: true

  # Database Configuration (PostgreSQL)
  # Tsuru 环境变量：PGHOST, PGPORT, PGDATABASE, PGUSER, PGPASSWORD
  # 本地开发时使用默认值
  datasource:
    url: jdbc:postgresql://${PGHOST:localhost}:${PGPORT:5433}/${PGDATABASE:imperial_profiles}
    driver-class-name: org.postgresql.Driver
    username: ${PGUSER:postgres}
    password: ${PGPASSWORD:123456}
    hikari:
      connection-timeout: 30000
      maximum-pool-size: 10
      # 允许启动时数据库暂时不可用（延迟连接验证）
      initialization-fail-timeout: -1
  
  # Transaction Management
  transaction:
    default-timeout: 30
  
  # 禁用自动执行 SQL 初始化脚本（防止启动时因脚本失败而崩溃）
  sql:
    init:
      mode: never

# MyBatis Plus
mybatis-plus:
  mapper-locations: classpath*:generator/mapper/*.xml,classpath*:com/zds/bioengtsnapp/mapper/*.xml
  configuration:
    log-impl: org.apache.ibatis.logging.stdout.StdOutImpl
    map-underscore-to-camel-case: true

deepseek:
  api:
    key: ${DEEPSEEK_API_KEY:your_api_key_here}
  base-url: https://api.deepseek.com
